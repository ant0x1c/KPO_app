<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>–°–≤–æ–¥–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º –∑–∞ [[${year}]]</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <script>
        // –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        (function() {
            const theme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-bs-theme', theme);
        })();
    </script>
</head>
<body class="container py-4">
    <!-- –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <form th:action="@{/logout}" method="post" class="position-absolute top-0 end-0 mt-3 me-3">
        <button type="submit" class="btn btn-outline-danger">–í—ã–π—Ç–∏</button>
    </form>

    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é -->
    <button class="menu-toggle-btn btn position-fixed top-0 start-0 m-3"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#sidebar"
            aria-controls="sidebar">
        ‚ò∞
    </button>

    <!-- –°–∞–π–¥–±–∞—Ä -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar" aria-labelledby="sidebarLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="sidebarLabel">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <a href="/expenses/list" class="btn btn-primary w-100 mb-3">–í—Å–µ —Ä–∞—Å—Ö–æ–¥—ã</a>
            <a href="/expenses/summary" class="btn btn-primary w-100 mb-3">üìä –°–≤–æ–¥–∫–∞ –ø–æ –≥–æ–¥–∞–º</a>
            <hr>

            <h6>–ü–æ –≥–æ–¥–∞–º –∏ –º–µ—Å—è—Ü–∞–º</h6>
            <div th:each="yearEntry : ${yearsWithMonths}">
                <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –≤–µ—Å—å –≥–æ–¥ -->
                <p class="fw-bold mt-3">
                    <a th:href="@{'/expenses/summary/year/' + ${yearEntry.key}}"
                       class="text-decoration-none"
                       th:text="${yearEntry.key}"></a>
                </p>
                <ul class="list-unstyled ms-3">
                    <li th:each="month : ${yearEntry.value}">
                        <a th:href="@{'/expenses/list'(year=${yearEntry.key}, month=${month})}"
                           th:text="${#temporals.format(T(java.time.LocalDate).of(yearEntry.key, month, 1), 'LLLL')}"
                           class="text-decoration-none text-secondary"></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <h2>–°–≤–æ–¥–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º –∑–∞ [[${year}]] –≥–æ–¥</h2>

    <table class="table table-striped">
        <thead>
        <tr>
            <th>–ú–µ—Å—è—Ü</th>
            <th>–°—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="monthEntry : ${monthlyTotals}">
            <td th:text="${#temporals.format(T(java.time.LocalDate).of(year, monthEntry.key, 1), 'LLLL')}"></td>
            <td th:text="${monthEntry.value} + ' ‚ÇΩ'"></td>
        </tr>
        <tr th:if="${monthlyTotals.isEmpty()}">
            <td colspan="2">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ —ç—Ç–æ—Ç –≥–æ–¥</td>
        </tr>
        </tbody>
    </table>

    <button id="themeToggleBtn"
            class="btn btn-secondary position-fixed bottom-0 end-0 m-3">
        üåì
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.getElementById('themeToggleBtn')?.addEventListener('click', function () {
            const currentTheme = document.documentElement.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-bs-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });
    </script>
</body>
</html>
